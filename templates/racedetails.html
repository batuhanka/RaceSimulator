<!DOCTYPE html>
<html>

<head>
    <title>Race Simulator</title>
    {% load static %}

    <link href="{% static 'img/favicon.png' %}" 			type="image/png"	rel="icon">
    <link href="{% static 'css/bootstrap.min.css' %}" 		type="text/css" 	rel="stylesheet">
    <link href="{% static 'css/bootstrap-toggle.min.css' %}"type="text/css" 	rel="stylesheet">
    <link href="{% static 'css/datatables.min.css' %}" 		type="text/css" 	rel="stylesheet">
    <link href="{% static 'css/fontawesome-all.min.css' %}"	type="text/css" 	rel="stylesheet">
    <link href="{% static 'css/tablesorterstyle.css'%}"     type="text/css"     rel="stylesheet">
    <link href="{% static 'css/racedetails.css'%}"     		type="text/css"     rel="stylesheet">
	

    <script src="{% static 'js/jquery-3.5.1.min.js' %}" 	type="text/javascript" charset="utf-8"></script>
    <script src="{% static 'js/popper.js' %}" 				type="text/javascript" charset="utf-8"></script>
    <script src="{% static 'js/bootstrap.min.js' %}" 		type="text/javascript" charset="utf-8"></script>
    <script src="{% static 'js/bootstrap-toggle.min.js' %}" type="text/javascript" charset="utf-8"></script>
    <script src="{% static 'js/datatables.min.js' %}" 		type="text/javascript" charset="utf-8"></script>
    <script src="{% static 'js/fontawesome-all.min.js' %}"	type="text/javascript" charset="utf-8"></script>
    <script src="{% static 'js/racesimulator.js' %}"		type="text/javascript" charset="utf-8" ></script>
    <script src="{% static 'js/tablesorter.js' %}"         	type="text/javascript" charset="utf-8"></script>

</head>

<body style="background:linear-gradient(to left, #870000, #bbb500);">

	<div class="container" style="max-width: 95%;">

	<br><br>
    <div class="page-header" style="text-align: center;">
        <h1><span class="badge badge-pill badge-info">{{ weather.location }}</span></h1>
		<!-- <h2><u>{{ weather.status }}</u></h2> -->
    </div>



		



		<!--      		<div class="progress">
                <div class="progress-bar" style="width:0%; background:#e95095;">
                    <h3 class="progress-title">HTML5</h3>
                    <div class="progress-value"><i class="fa-solid fa-horse"></i></div>
                </div>
            </div>
    	-->

<script>

$(".progress-bar").animate({
    width: "100%"
}, 12500);
</script>  

	{% for singlerace in racedetails %}
	<div id="accordion-{{ singlerace.key }}">
  	<div class="card" style="border-bottom-left-radius:40px; border-bottom-right-radius: 40px; margin-top:2%;">
    <div class="card-header text-white bg-{{ singlerace.courtbg }} float-left" style="border-bottom-left-radius:40px; border-bottom-right-radius: 40px;" id="{{ singlerace.key }}-header">
        <button class="btn text-white bg-{{ singlerace.courtbg }}" data-toggle="collapse" data-target="#collapse{{ singlerace.key }}" aria-expanded="true" aria-controls="collapse{{ singlerace.key }}">
          <span class="label label-{{ singlerace.courtbg }} left" style="text-decoration: underline;"><b>{{ singlerace.racenumber }}. KOŞU : {{ singlerace.time }} {{ singlerace.summary }} : {{ singlerace.racename }}</b></span> 
        </button>
        <button style="display:none;" type="button" class="btn btn-danger simulation float-right"><span class="fa-solid fa-flag-checkered fa-shake"></span><b> Simulasyon</b></button>
        <button type="button" class="btn btn-{{ singlerace.courtbg }} velocities float-right" style="margin-right: 1%;"><span class="fa-solid fa-calculator fa-beat-fade"></span><b> Hesapla</b></button>
        <span class="label text-{{ singlerace.courtbg }} label-{{ singlerace.courtbg }} float-right courtcode">{{ singlerace.courtcode }}</span>
        <div><span raceid="{{ singlerace.key }}" racedate="{{ singlerace.date }}" cityinfo="{{ weather.cityinfo }}" citycode="{{ weather.citycode }}"  class="label text-white label-{{ singlerace.courtbg }} racerule"></span></div>
        
     </div>
     
    
     
	
	{% if nextracetime > singlerace.time and singlerace.time > currenttime %}
    	<div id="collapse{{ singlerace.key }}" class="collapse show" aria-labelledby="{{ singlerace.key }}-header" data-parent="#accordion-{{ singlerace.key }}">
    {% else %}
    	<div id="collapse{{ singlerace.key }}" class="collapse" aria-labelledby="{{ singlerace.key }}-header" data-parent="#accordion-{{ singlerace.key }}">
    {% endif %}
      <div class="card-body table-responsive">
      
      <table id="horselist-{{ singlerace.key }}" class="table table-hover align-middle text-left racetable" style="font-size:small">
      	<thead class="thead-light">
        	<tr>
        		<th class="text-center">Sonuç</th>
            	<th>Forma</th> 
                <th>No</th>
				<th>At İsmi</th>
                <th>Yaş</th>
                <th>Kilo</th>
                <th>Baba / Anne</th>
                <th>HP</th>
                <th>Jokey</th>
                <th>KGS</th>
                <th>Son6</th>
                <th>YK</th>
                <th>Tümü</th>
                <th>Tabela</th>
				<th>Galop</th>
                <th>Detay</th>
                <th>AGF1</th>
                <th>AGF2</th>
                <th style="display:none;">Start</th>
                <th style="display:none;">Sahip / Antrenör</th>
           </tr>
       </thead>
       
       <tbody>
       		{% for horse in allhorses %}
       		{% if horse.racecode  == singlerace.key %}
       		<tr>
       			
       			{% if horse.result == 0 %}
       			<td> </td>
       			{% else %}
       			<td class="text-danger text-center align-middle"><b>{% if horse.result != 1000 %} {{ horse.result }} {% else %} <p style="color:transparent; cursor:default;">1000</p> {% endif %}</b></td>
       			{% endif %} 
       			<td class="align-middle"><img src="{{ horse.jerseyimg }}" width="40" height="40"></td>
       			<td class="align-middle text-center text-info"><b>{{ horse.number }}</b></td>
       			{% if horse.disabled == True %}
       			<td class="align-middle"><button type="button" class="btn btn-sm btn-outline-danger" style="cursor:text">[K] <s>{{ horse.name }}</s></button>
       			{% endif %}
       			{% if horse.disabled == False %}
       			<td class="align-middle"><span>{{ horse.name }}
       			{% endif %}
       			<sup class="text-info"><b>{{ horse.tool }}</b></sup>
       			{% if horse.stablemate != False %}<img src="https://medya-cdn.tjk.org/imageftp/Img/e{{ horse.stablemate }}.gif"></span>{% endif %}
       			</td>
       			<td class="align-middle"><span class="badge badge-pill" style="font-size: x-small;">{{ horse.age }}</span></td>
       			<td class="align-middle">{{ horse.weight }}
       			{% if horse.weightex != 0 %}
       			 <sup class="text-info"><b>+{{ horse.weightex }}</b></sup> </td>
       			{% endif %}
       			
       			<td class="align-middle parent" horsecode="{{ horse.code }}"> 
       			<span class="badge badge-pill" style="font-size: x-small; margin:1%;">{{ horse.fathername }}</span> <br>
       			<span class="badge badge-pill" style="font-size: x-small; margin:1%;">{{ horse.mothername }} </span> </td>
       			<td class="align-middle">{{ horse.handycap }}</td>
       			<td class="align-middle">{{ horse.jockey }}
       			{% if horse.apprantice == True %}<sup class="text-info"><b>AP</b></sup>{% endif %}
       			</td>
       			<td class="align-middle">{{ horse.kgs }}</td>
				<td class="align-middle">{{ horse.lastsix }}</td>
       			<td class="align-middle"><button id="{{ horse.code }}" type="button" class="btn btn-outline-info yearprize"><span class="fa-solid fa-turkish-lira-sign"></span></button></td>
       			<td class="align-middle"><button id="{{ horse.code }}" courtcode="{{ singlerace.courtcode }}" distance="{{ singlerace.distance }}" weight="{{ horse.weight }}" type="button" class="btn btn-outline-info horsepower"><span class="fas fa-rocket"></span></button></td>
       			<td class="align-middle"><button id="{{ horse.code }}" courtcode="{{ singlerace.courtcode }}" distance="{{ singlerace.distance }}" weight="{{ horse.weight }}" type="button" class="btn btn-outline-info horsespeed"><i class="fa-solid fa-medal"></i></button></td>
       			<td class="align-middle"><button id="{{ horse.code }}" courtcode="{{ singlerace.courtcode }}" distance="{{ singlerace.distance }}" weight="{{ horse.weight }}" horsename="{{ horse.name }}" type="button" class="btn btn-outline-info gallop"><i class="fa-solid fa-history"></i></button></td>
       			
				<td class="align-middle">
       			<button id="{{ horse.code }}" horseinfo="{{ horse.number }} - {{ horse.name }}" racecode="{{ horse.racecode }}" cityname="{{ weather.cityname }}" dateinfo="{{ singlerace.daterequest }}" type="button" class="btn btn-outline-info statsinfo" data-toggle="modal" data-target="#statsModalCenter"><i class="fa-solid fa-th-list"></i></button>
       			</td>
       			
       			<td class="align-middle">
       			{% if horse.agf1 %}
       			<div class="agfprogress mx-auto" data-value='{{ horse.agf1 }}' style="max-height:60px; max-width:60px;">
          		<span class="agfprogress-left">
                        <span class="agfprogress-bar border-info"></span>
          		</span>
          		<span class="agfprogress-right">
                        <span class="agfprogress-bar border-info"></span>
          		</span>
          		<div class="agfprogress-value w-100 h-100 rounded-circle d-flex align-items-center justify-content-center">
            	<div class="text-info font-weight-bold">%{{ horse.agf1 }}</div>
          		</div>
        		</div>
        		{% endif %}
        		</td>
        		
        		
        		
        		<td class="align-middle">
        		{% if horse.agf2 %}
        		<div class="agfprogress mx-auto" data-value='{{ horse.agf2 }}' style="max-height:60px; max-width:60px;">
          		<span class="agfprogress-left">
                        <span class="agfprogress-bar border-info"></span>
          		</span>
          		<span class="agfprogress-right">
                        <span class="agfprogress-bar border-info"></span>
          		</span>
          		<div class="agfprogress-value w-100 h-100 rounded-circle d-flex align-items-center justify-content-center">
            	<div class="text-info font-weight-bold">%{{ horse.agf2 }}</div>
          		</div>
        		</div>
        		{% endif %}
       			</td>
       			<td style="display:none;">{{ horse.startno }}</td>
       			<td style="display:none;">
       			<span>{{ horse.owner }}</span> <br> 
       			<span>{{ horse.trainer }}</span> 
       			</td>
       			
       		</tr>
       		{% endif %}
      		{% endfor %}
       </tbody>
       <tfoot>
       		<tr><td colspan="18" class="text-info"><b>{{ singlerace.betinfo }}</b></td></tr>
       	</tfoot>
       	</table>
      

      </div>
    </div>
  	</div>
	</div> <!--  end of accordion -->
	{% endfor %}


   </div> <!-- end of container -->
   <br><br><br>
      
   <!-- Modal -->
<div class="modal fade" id="statsModalCenter" tabindex="-1" role="dialog" aria-labelledby="statsModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" style="max-width: 95%;" role="document">
    <div class="modal-content">
      <div class="modal-header text-center bg-info" style="border-bottom-left-radius:40px; border-bottom-right-radius: 40px;">
        <h5 class="modal-title" id="statsModalLongTitle">İstatistikler</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div id="statsmodalbody" class="modal-body">
        
        <div class="form-group row">
        
        	<div class="col" style="margin-top:0.5%;">
				<table id="rivalstatsinfo" class="table table-bordered table-striped" style="font-size:small; display:none;">
				<thead class="bg-info text-black">
				<tr>
					<th style="text-align:center">Rakipleri</th>
					<th style="text-align:center">Geçtiği</th>
					<th style="text-align:center">Geçildiği</th>
					<th style="text-align:center">Toplam</th>
				</tr>
				</thead>
				<tbody>

				</tbody>
				</table>
			
    		</div>
        
        
            <div id="statsinfodiv" class="col">
            	<div id="loadingdiv" style="text-align: center;">
					<button class="btn btn-white text-info" type="button" disabled>
  					<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span><b> Yükleniyor . . .</b></button>
            	</div>
			</div>
			
    		
    		<div id="siblinginfodiv" class="col">
			
    		</div>
  		</div>


        
      </div>
      <div class="modal-footer">
        <button id="statsclosebtn" type="button" class="btn btn-outline-info" data-dismiss="modal">Kapat</button>
      </div>
    </div>
  </div>
</div>   
  
  <input type="hidden" id="citynameinput" value="{{ cityname }}">
  
  </div>
  
  </body> 

</html>
